<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title th:text="${restaurant.name} + ' Menu'">Restaurant Menu</title>
	<link rel="stylesheet" th:href="@{/css/bootstrap.css}">
	<link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Poppins', sans-serif;
			background-color: #fffaf3;
		}
		.navbar-custom {
			background: linear-gradient(135deg, #fc8019 0%, #e66a00 100%);
			padding: 15px 0;
		}
		.navbar-custom .navbar-brand, .navbar-custom .nav-link {
			color: #fff;
			font-weight: 500;
		}
		.menu-item-card {
			background: #fff;
			border: 2px solid #e0e0e0;
			border-radius: 15px;
			padding: 20px;
			margin-bottom: 15px;
			transition: all 0.3s ease;
		}
		.menu-item-card:hover {
			border-color: #fc8019;
			transform: translateY(-3px);
			box-shadow: 0 4px 15px rgba(220, 53, 69, 0.2);
		}
		.btn-primary {
			background: linear-gradient(135deg, #fc8019 0%, #e66a00 100%);
			border: none;
			border-radius: 50px;
			padding: 12px 25px;
			font-weight: 600;
		}
	</style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-custom">
	<div class="container">
		<a class="navbar-brand" th:href="@{/company/dashboard}">Tummy Go! - Company</a>
		<div class="ml-auto">
			<a class="nav-link" th:href="@{/company/dashboard}">Dashboard</a>
			<a class="nav-link" th:href="@{/company/orders}">Orders</a>
			<a class="nav-link" th:href="@{/logout}">Logout</a>
		</div>
	</div>
</nav>

<div class="container py-4">
	<h2 class="mb-4" th:text="${restaurant.name}">Restaurant Name</h2>
	
	<div class="alert alert-info mb-4">
		<strong>Subscription:</strong> <span th:text="${activeSubscription.subscriptionPackage.name}"></span><br>
		<strong>Order Quantity:</strong> <span th:text="${activeSubscription.subscriptionPackage.numberOfPeople}">10</span> servings (fixed)
	</div>

	<div th:if="${#lists.isEmpty(menuItems)}" class="alert alert-warning">
		No menu items available at this restaurant.
	</div>

	<div th:if="${!#lists.isEmpty(menuItems)}">
		<div class="menu-item-card" th:each="item : ${menuItems}">
			<div class="row">
				<div class="col-md-8">
					<h5 th:text="${item.name}">Item Name</h5>
					<p class="text-muted mb-2" th:text="${item.description ?: 'No description available'}">Description</p>
					<p class="mb-0"><strong>Price:</strong> ₹<span th:text="${#numbers.formatDecimal(item.price, 0, 2)}">0.00</span></p>
					<p class="mb-0"><strong>Total for <span th:text="${activeSubscription.subscriptionPackage.numberOfPeople}">10</span> servings:</strong> 
						₹<span th:text="${#numbers.formatDecimal(item.price * activeSubscription.subscriptionPackage.numberOfPeople, 0, 2)}">0.00</span></p>
				</div>
				<div class="col-md-4 text-right">
					<button type="button" class="btn btn-primary" th:onclick="'showOrderModal(' + ${item.id} + ', ' + ${item.price} + ')'">
						<i class="fa fa-shopping-cart mr-2"></i>Order Now
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Order Modal -->
<div class="modal fade" id="orderModal" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">Place Order</h5>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>
			<form th:action="@{/company/orders/place}" method="post">
				<input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
				<input type="hidden" name="menuItemId" id="modalMenuItemId">
				<input type="hidden" name="orderDate" th:value="${#temporals.format(orderDate, 'yyyy-MM-dd')}">
				<input type="hidden" name="quantity" th:value="${activeSubscription.subscriptionPackage.numberOfPeople}">
				
				<div class="modal-body">
					<div class="form-group">
						<label>Delivery Address *</label>
						<textarea class="form-control" name="deliveryAddress" rows="3" required
								  placeholder="Enter your office delivery address..."></textarea>
						<small class="form-text text-muted">This is where the food will be delivered</small>
					</div>
					
					<div class="form-group">
						<label>Special Instructions</label>
						<textarea class="form-control" name="specialInstructions" rows="2"
								  placeholder="Any special instructions..."></textarea>
					</div>
					
					<div class="alert alert-info">
						<strong>Quantity:</strong> <span th:text="${activeSubscription.subscriptionPackage.numberOfPeople}">10</span> servings<br>
						<strong>Total Amount:</strong> ₹<span id="modalTotalAmount">0.00</span>
					</div>
				</div>
				
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
					<button type="submit" class="btn btn-primary">Place Order</button>
				</div>
			</form>
		</div>
	</div>
</div>

<script th:inline="javascript">
	var subscriptionQuantity = /*[[${activeSubscription.subscriptionPackage.numberOfPeople}]]*/ 10;
	
	function showOrderModal(itemId, price) {
		document.getElementById('modalMenuItemId').value = itemId;
		var total = price * subscriptionQuantity;
		document.getElementById('modalTotalAmount').textContent = total.toFixed(2);
		$('#orderModal').modal('show');
	}
</script>

<script th:src="@{/js/jquery-3.4.1.min.js}"></script>
<script th:src="@{/js/bootstrap.js}"></script>
</body>
</html>

